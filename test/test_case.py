import numpy as np
from context import Structural_Parameters
import pandas as pd

Test_Galaxy = {'name': 'ESO479-G1',
               'D': 68.51e6, # pc
               'D E': 4.8e6, # pc
               'Vcmb': 4645, # km/s
               'Vcmb E': 14, # km/s
               'Vhel': 4846.145762, # km/s
               'Vhel E': 2.997925, # km/s
               'zhel': 0.01616,
               'zhel E': 0.00001,
               'RA J2000': 36.368083, # deg
               'DEC J2000': -25.637917, # deg
               'q0': 0.05,
               'plot': {'all': True},
               'SB': {'g': {'extinction': 0.056}, 'r': {'extinction': 0.039}, 'z': {'extinction': 0.021}},
               'RC': {'R': np.array([-38.88, -35.64, -32.4, -29.16, -25.92, -22.68, -19.44, -16.2, -12.96, -9.72, -6.48, -3.24, 0.0, 3.24, 6.48, 9.72, 12.96, 16.2, 19.44, 22.68, 25.92, 29.16, 32.4, -38.88, -35.64, -32.4, -29.16, -25.92, -22.68, -19.44, -16.2, -12.96, -9.72, -6.48, -3.24, 0.0, 3.24, 6.48, 9.72, 12.96, 16.2, 19.44, 22.68, 25.92, 29.16, 32.4]),
                      'v': np.array([4711.01, 4759.29, 4755.86, 4770.26, 4759.11, 4750.07, 4750.86, 4737.13, 4749.14, 4758.47, 4760.86, 4788.56, 4823.55, 4849.74, 4870.65, 4876.4, 4891.95, 4877.9, 4900.67, 4901.99, 4889.45, 4877.65, 4875.9, 4711.01, 4759.29, 4755.86, 4770.26, 4759.11, 4750.07, 4750.86, 4737.13, 4749.14, 4758.47, 4760.86, 4788.56, 4823.55, 4849.74, 4870.65, 4876.4, 4891.95, 4877.9, 4900.67, 4901.99, 4889.45, 4877.65, 4875.9]),
                      'v E': np.array([0.083359256, 0.7414152, 0.7825504, 0.6111895, 0.4627294, 0.6041303, 0.5453588, 0.4766805, 0.9099643, 1.0, 0.8796334, 0.8591256, 0.8515519, 0.8601306, 0.8815358, 0.8856996, 0.9055493, 0.666204, 0.2991457, 0.3949485, 0.4521644, 0.441767, 0.2543373, 0.083359256, 0.7414152, 0.7825504, 0.6111895, 0.4627294, 0.6041303, 0.5453588, 0.4766805, 0.9099643, 1.0, 0.8796334, 0.8591256, 0.8515519, 0.8601306, 0.8815358, 0.8856996, 0.9055493, 0.666204, 0.2991457, 0.3949485, 0.4521644, 0.441767, 0.2543373])},
}

for b in Test_Galaxy['SB']:
    T = pd.read_csv(f'ESO479-g1_{b}.prof', skiprows = 1)
    Test_Galaxy['SB'][b]['R'] = np.array(T['R'])
    Test_Galaxy['SB'][b]['sb'] = np.array(T['SB'])
    Test_Galaxy['SB'][b]['sb E'] = np.array(T['SB_e'])
    Test_Galaxy['SB'][b]['m'] = np.array(T['totmag'])
    Test_Galaxy['SB'][b]['m E'] = np.array(T['totmag_e'])
    Test_Galaxy['SB'][b]['q'] = np.array(1 - T['ellip'])
    Test_Galaxy['SB'][b]['q E'] = np.array(T['ellip_e'])
    
Structural_Parameters.draw('pipeline.png')
with open('galaxy_parameters.txt', 'w') as f:
    f.write(str(Structural_Parameters(Test_Galaxy)))
